<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.shuoshuoyun.cn","root":"/","scheme":"Gemini","version":"8.0.0-rc.4","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"path":"search.xml"};
  </script>

  <meta name="description" content="第二部分 编程指南与其他框架集成1.0.8版中的新功能。">
<meta property="og:type" content="article">
<meta property="og:title" content="Kivy参考文档（三）">
<meta property="og:url" content="https://blog.shuoshuoyun.cn/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/index.html">
<meta property="og:site_name" content="木今心">
<meta property="og:description" content="第二部分 编程指南与其他框架集成1.0.8版中的新功能。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-03-03T01:12:17.000Z">
<meta property="article:modified_time" content="2020-07-15T14:30:09.612Z">
<meta property="article:author" content="Shuoshuo">
<meta property="article:tag" content="kivy">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.shuoshuoyun.cn/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Kivy参考文档（三） | 木今心</title>
  


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?07fdd26aa39a30ab9c8d553e566c50ee";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">木今心</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">9</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第二部分-编程指南"><span class="nav-text">第二部分 编程指南</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#与其他框架集成"><span class="nav-text">与其他框架集成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#在Kivy中使用Twisted"><span class="nav-text">在Kivy中使用Twisted</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#服务器应用"><span class="nav-text">服务器应用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户应用"><span class="nav-text">客户应用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#打包您的应用程序"><span class="nav-text">打包您的应用程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#为Windows创建一个程序包"><span class="nav-text">为Windows创建一个程序包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#要求"><span class="nav-text">要求</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PyInstaller默认钩子"><span class="nav-text">PyInstaller默认钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#打包一个简单的应用程序"><span class="nav-text">打包一个简单的应用程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用gstreamer打包视频应用"><span class="nav-text">使用gstreamer打包视频应用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#覆盖默认钩子"><span class="nav-text">覆盖默认钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#包含-排除视频和音频并减小应用程序大小"><span class="nav-text">包含&#x2F;排除视频和音频并减小应用程序大小</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#备用安装"><span class="nav-text">备用安装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为Android创建一个程序包"><span class="nav-text">为Android创建一个程序包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Buildozer"><span class="nav-text">Buildozer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#用python-for-android打包"><span class="nav-text">用python-for-android打包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#打包您的Kivy-Launcher应用程序"><span class="nav-text">打包您的Kivy Launcher应用程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#投放市场"><span class="nav-text">投放市场</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定位Android"><span class="nav-text">定位Android</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Kivy-on-Android"><span class="nav-text">Kivy on Android</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Android套件"><span class="nav-text">Android套件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在Android平台上调试应用程序"><span class="nav-text">在Android平台上调试应用程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用Android-API"><span class="nav-text">使用Android API</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#项目和经过测试的设备的状态"><span class="nav-text">项目和经过测试的设备的状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为OS-X创建软件包"><span class="nav-text">为OS X创建软件包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用PyInstaller和Homebrew"><span class="nav-text">使用PyInstaller和Homebrew</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在没有Homebrew的情况下使用PyInstaller"><span class="nav-text">在没有Homebrew的情况下使用PyInstaller</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编译发行版"><span class="nav-text">编译发行版</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建一个Xcode项目"><span class="nav-text">创建一个Xcode项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义Xcode项目"><span class="nav-text">自定义Xcode项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#已知的问题"><span class="nav-text">已知的问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FAQ"><span class="nav-text">FAQ</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Shuoshuo"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">Shuoshuo</p>
  <div class="site-description" itemprop="description">站在巨人的肩上</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NreWJsdWV2eA==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Skybluevx"><i class="fab fa-github fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjEzNzI3NTU0NzJAcXEuY29t" title="E-Mail → mailto:1372755472@qq.com"><i class="fa fa-envelope fa-fw"></i></span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



      </section>
        <div class="back-to-top animated">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NreWJsdWV2eA==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.shuoshuoyun.cn/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="Shuoshuo">
      <meta itemprop="description" content="站在巨人的肩上">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="木今心">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Kivy参考文档（三）
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-03 09:12:17" itemprop="dateCreated datePublished" datetime="2020-03-03T09:12:17+08:00">2020-03-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-15 22:30:09" itemprop="dateModified" datetime="2020-07-15T22:30:09+08:00">2020-07-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Kivy/" itemprop="url" rel="index"><span itemprop="name">Kivy</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="第二部分-编程指南"><a href="#第二部分-编程指南" class="headerlink" title="第二部分 编程指南"></a>第二部分 编程指南</h1><h2 id="与其他框架集成"><a href="#与其他框架集成" class="headerlink" title="与其他框架集成"></a>与其他框架集成</h2><p>1.0.8版中的新功能。</p>
<a id="more"></a>

<h3 id="在Kivy中使用Twisted"><a href="#在Kivy中使用Twisted" class="headerlink" title="在Kivy中使用Twisted"></a>在Kivy中使用Twisted</h3><hr>
<p><strong>注意：您可以使用kivy.support.install_twisted_reactor函数安装将在kivy事件循环内运行的扭曲反应堆。</strong></p>
<p><strong>传递给该函数的所有参数或关键字参数都将在threadedselect反应堆交错函数上传递。 这些通常是扭曲式反应堆的论据。 startRunning</strong></p>
<hr>
<p><strong>警告：与默认的双绞线电抗器不同，已安装的电抗器将不会处理任何信号，除非您将“ installSignalHandlers”关键字参数明确设置为1。 这样做是为了使kivy能够照常处理信号，除非您特别希望扭曲电抗器处理信号（例如SIGINT）。</strong></p>
<hr>
<ul>
<li><span class="exturl" data-url="aHR0cDovL3R3aXN0ZWRtYXRyaXguY29tL2RvY3VtZW50cy9jdXJyZW50L19kb3dubG9hZHMvc2ltcGxlc2Vydi5weQ==">http://twistedmatrix.com/documents/current/_downloads/simpleserv.py<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3R3aXN0ZWRtYXRyaXguY29tL2RvY3VtZW50cy9jdXJyZW50L19kb3dubG9hZHMvc2ltcGxlY2xpZW50LnB5">http://twistedmatrix.com/documents/current/_downloads/simpleclient.py<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>要尝试该示例，请首先运行echo_server_app.py，然后启动echo_client_app.py。 在文本框中输入内容后，当您按Enter键时，服务器将以简单的回显消息答复客户端应用发送的任何内容。</p>
<h4 id="服务器应用"><a href="#服务器应用" class="headerlink" title="服务器应用"></a>服务器应用</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install_twisted_rector must be called before importing and using the reactor</span></span><br><span class="line"><span class="keyword">from</span> kivy.support <span class="keyword">import</span> install_twisted_reactor</span><br><span class="line"></span><br><span class="line">install_twisted_reactor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> twisted.internet <span class="keyword">import</span> reactor</span><br><span class="line"><span class="keyword">from</span> twisted.internet <span class="keyword">import</span> protocol</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoServer</span><span class="params">(protocol.Protocol)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dataReceived</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        response = self.factory.app.handle_message(data)</span><br><span class="line">        <span class="keyword">if</span> response:</span><br><span class="line">            self.transport.write(response)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoServerFactory</span><span class="params">(protocol.Factory)</span>:</span></span><br><span class="line">    protocol = EchoServer</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, app)</span>:</span></span><br><span class="line">        self.app = app</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> kivy.app <span class="keyword">import</span> App</span><br><span class="line"><span class="keyword">from</span> kivy.uix.label <span class="keyword">import</span> Label</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwistedServerApp</span><span class="params">(App)</span>:</span></span><br><span class="line">    label = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.label = Label(text=<span class="string">"server started\n"</span>)</span><br><span class="line">        reactor.listenTCP(<span class="number">8000</span>, EchoServerFactory(self))</span><br><span class="line">        <span class="keyword">return</span> self.label</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_message</span><span class="params">(self, msg)</span>:</span></span><br><span class="line">        msg = msg.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        self.label.text = <span class="string">"received: &#123;&#125;\n"</span>.format(msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> msg == <span class="string">"ping"</span>:</span><br><span class="line">            msg = <span class="string">"Pong"</span></span><br><span class="line">        <span class="keyword">if</span> msg == <span class="string">"plop"</span>:</span><br><span class="line">            msg = <span class="string">"Kivy Rocks!!!"</span></span><br><span class="line">        self.label.text += <span class="string">"responded: &#123;&#125;\n"</span>.format(msg)</span><br><span class="line">        <span class="keyword">return</span> msg.encode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    TwistedServerApp().run()</span><br></pre></td></tr></table></figure>

<h4 id="客户应用"><a href="#客户应用" class="headerlink" title="客户应用"></a>客户应用</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install_twisted_rector must be called before importing the reactor</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> unicode_literals</span><br><span class="line"><span class="keyword">from</span> kivy.support <span class="keyword">import</span> install_twisted_reactor</span><br><span class="line"></span><br><span class="line">install_twisted_reactor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># A Simple Client that send messages to the Echo Server</span></span><br><span class="line"><span class="keyword">from</span> twisted.internet <span class="keyword">import</span> reactor, protocol</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoClient</span><span class="params">(protocol.Protocol)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connectionMade</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.factory.app.on_connection(self.transport)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dataReceived</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        self.factory.app.print_message(data.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoClientFactory</span><span class="params">(protocol.ClientFactory)</span>:</span></span><br><span class="line">    protocol = EchoClient</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, app)</span>:</span></span><br><span class="line">        self.app = app</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startedConnecting</span><span class="params">(self, connector)</span>:</span></span><br><span class="line">        self.app.print_message(<span class="string">'Started to connect.'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clientConnectionLost</span><span class="params">(self, connector, reason)</span>:</span></span><br><span class="line">        self.app.print_message(<span class="string">'Lost connection.'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clientConnectionFailed</span><span class="params">(self, connector, reason)</span>:</span></span><br><span class="line">        self.app.print_message(<span class="string">'Connection failed.'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> kivy.app <span class="keyword">import</span> App</span><br><span class="line"><span class="keyword">from</span> kivy.uix.label <span class="keyword">import</span> Label</span><br><span class="line"><span class="keyword">from</span> kivy.uix.textinput <span class="keyword">import</span> TextInput</span><br><span class="line"><span class="keyword">from</span> kivy.uix.boxlayout <span class="keyword">import</span> BoxLayout</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># A simple kivy App, with a textbox to enter messages, and</span></span><br><span class="line"><span class="comment"># a large label to display all the messages received from</span></span><br><span class="line"><span class="comment"># the server</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwistedClientApp</span><span class="params">(App)</span>:</span></span><br><span class="line">    connection = <span class="literal">None</span></span><br><span class="line">    textbox = <span class="literal">None</span></span><br><span class="line">    label = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">(self)</span>:</span></span><br><span class="line">        root = self.setup_gui()</span><br><span class="line">        self.connect_to_server()</span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_gui</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.textbox = TextInput(size_hint_y=<span class="number">.1</span>, multiline=<span class="literal">False</span>)</span><br><span class="line">        self.textbox.bind(on_text_validate=self.send_message)</span><br><span class="line">        self.label = Label(text=<span class="string">'connecting...\n'</span>)</span><br><span class="line">        layout = BoxLayout(orientation=<span class="string">'vertical'</span>)</span><br><span class="line">        layout.add_widget(self.label)</span><br><span class="line">        layout.add_widget(self.textbox)</span><br><span class="line">        <span class="keyword">return</span> layout</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connect_to_server</span><span class="params">(self)</span>:</span></span><br><span class="line">        reactor.connectTCP(<span class="string">'localhost'</span>, <span class="number">8000</span>, EchoClientFactory(self))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_connection</span><span class="params">(self, connection)</span>:</span></span><br><span class="line">        self.print_message(<span class="string">"Connected successfully!"</span>)</span><br><span class="line">        self.connection = connection</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_message</span><span class="params">(self, *args)</span>:</span></span><br><span class="line">        msg = self.textbox.text</span><br><span class="line">        <span class="keyword">if</span> msg <span class="keyword">and</span> self.connection:</span><br><span class="line">            self.connection.write(msg.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">            self.textbox.text = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_message</span><span class="params">(self, msg)</span>:</span></span><br><span class="line">        self.label.text += <span class="string">"&#123;&#125;\n"</span>.format(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    TwistedClientApp().run()</span><br></pre></td></tr></table></figure>

<h2 id="打包您的应用程序"><a href="#打包您的应用程序" class="headerlink" title="打包您的应用程序"></a>打包您的应用程序</h2><h3 id="为Windows创建一个程序包"><a href="#为Windows创建一个程序包" class="headerlink" title="为Windows创建一个程序包"></a>为Windows创建一个程序包</h3><hr>
<p><strong>注意：本文档仅适用于kivy 1.9.1及更高版本。</strong></p>
<hr>
<p>为Windows平台打包应用程序只能在Windows OS内完成。 以下过程已在装有Kivy轮的Windows上进行了测试，有关替代安装，请参见最后。</p>
<p>软件包将是32位还是64位，具体取决于您使用哪个版本的Python。</p>
<h4 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h4><ul>
<li>最新的Kivy（如Installation_windows中所述安装）.</li>
<li>PyInstaller 3.1+（pip install –upgrade pyinstaller）.</li>
</ul>
<h3 id="PyInstaller默认钩子"><a href="#PyInstaller默认钩子" class="headerlink" title="PyInstaller默认钩子"></a>PyInstaller默认钩子</h3><p>本节适用于包含kivy钩子的PyInstaller（&gt; = 3.1）。 要覆盖默认钩子，需要对以下示例进行一些修改。 请参阅覆盖默认挂钩。</p>
<h4 id="打包一个简单的应用程序"><a href="#打包一个简单的应用程序" class="headerlink" title="打包一个简单的应用程序"></a>打包一个简单的应用程序</h4><p>在此示例中，我们将打包touchtracer示例项目并嵌入自定义图标。 kivy示例的位置是，当使用轮子时，安装到python \ share \ kivy-examples上，以及将github源代码安装为kivy \ examples时。 我们仅将通向示例的完整路径称为examples-path。 touchtracer示例位于examples-path \ demo \ touchtracer中，主文件名为main.py。</p>
<p>1.打开命令行外壳，并确保python在路径上（即python可以工作）。</p>
<p>2.创建一个文件夹，将在其中创建打包的应用程序。 例如，创建一个TouchApp文件夹，然后使用更改为该目录。 <code>cd TouchApp</code>。 然后输入：</p>
<p><code>python -m PyInstaller --name touchtracer examples-path\demo\touchtracer\main.py</code></p>
<p>您也可以将icon.ico文件添加到应用程序文件夹中，以便为可执行文件创建图标。 如果没有.ico文件，则可以使用网络应用程序ConvertICO将icon.png文件转换为ico。 将icon.ico保存在touchtracer目录中，然后键入：</p>
<p><code>python -m PyInstaller --name touchtracer --icon examples-path\demo\touchtracer\icon.ico examples-path\demo\touchtracer\main.py</code></p>
<p>有关更多选项，请查阅PyInstaller手册。</p>
<p>3.规格文件将是TouchApp中的touchtracer.spec。 现在，我们需要编辑spec文件以添加依赖项挂钩以正确构建exe。 使用您喜欢的编辑器打开规范文件，并在规范的开头添加以下几行（假设使用了sdl2，现在是默认设置）：</p>
<p><code>from kivy_deps import sdl2, glew</code></p>
<p>然后，找到COLLECT（）并添加touchtracer的数据（touchtracer.kv，Particle.png，…）：更改该行以添加Tree（）对象，例如 树（’examples-path \ demo \ touchtracer \‘）。 该树将搜索并将在touchtracer目录中找到的每个文件添加到最终包中。</p>
<p>要添加依赖关系，请在COLLECT中的第一个关键字参数之前为依赖关系的每个路径添加一个Tree对象。 例如。 * [[（sdl2.dep_bins + glew。dep_bins）中p的树（p）]看起来像这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">coll = COLLECT(exe, Tree(<span class="string">'examples-path\\demo\\touchtracer\\'</span>),</span><br><span class="line">                a.binaries,</span><br><span class="line">                a.zipfiles,</span><br><span class="line">                a.datas,</span><br><span class="line">                *[Tree(p) <span class="keyword">for</span> p <span class="keyword">in</span> (sdl2.dep_bins + glew.dep_bins)],</span><br><span class="line">                strip=<span class="literal">False</span>,</span><br><span class="line">                upx=<span class="literal">True</span>,</span><br><span class="line">                name=<span class="string">'touchtracer'</span>)</span><br></pre></td></tr></table></figure>
<p>4.现在，我们使用以下命令在TouchApp中构建规范文件：</p>
<p><code>python -m PyInstaller touchtracer.spec</code></p>
<p>5.编译后的软件包将位于<code>TouchApp\dist\touchtracer</code>目录中。</p>
<h4 id="使用gstreamer打包视频应用"><a href="#使用gstreamer打包视频应用" class="headerlink" title="使用gstreamer打包视频应用"></a>使用gstreamer打包视频应用</h4><p>接下来，我们将略微修改上面的示例，以打包将gstreamer用于视频的应用。 我们将使用在<code>examples-path\widgets\videoplayer.py</code>中找到的视频播放器示例。 在名为VideoPlayer的位置创建一个文件夹，然后在命令行上将当前目录更改为该文件夹并执行以下操作：</p>
<p><code>python -m PyInstaller --name gstvideo examples-path\widgets\videoplayer.py</code></p>
<p>创建gstvideo.spec文件。 如上编辑，这次也包括gstreamer依赖项：</p>
<p><code>from kivy_deps import sdl2, glew, gstreamer</code></p>
<p>并添加Tree（）以包括视频文件，例如 Tree（’examples-path \ widgets’）以及gstreamer依赖项，因此它应类似于：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">coll = COLLECT(exe, Tree(<span class="string">'examples-path\\widgets'</span>),</span><br><span class="line">                a.binaries,</span><br><span class="line">                a.zipfiles,</span><br><span class="line">                a.datas,</span><br><span class="line">                *[Tree(p) <span class="keyword">for</span> p <span class="keyword">in</span> (sdl2.dep_bins + glew.dep_bins + gstreamer.dep_bins)],</span><br><span class="line">                strip=<span class="literal">False</span>,</span><br><span class="line">                upx=<span class="literal">True</span>,</span><br><span class="line">                name=<span class="string">'gstvideo'</span>)</span><br></pre></td></tr></table></figure>
<p>然后使用以下方法在VideoPlayer中构建规格文件：</p>
<p><code>python -m PyInstaller gstvideo.spec</code></p>
<p>并且您应该在<code>VideoPlayer\dist\gstvideo</code>中找到gstvideo.exe，该文件在运行时将播放视频。</p>
<hr>
<p><strong>注意：如果您使用的是Pygame，并且在打包应用中需要PyGame，则由于kivy问题＃1638，您必须在规范文件中添加以下代码。 导入后，添加以下内容：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getResource</span><span class="params">(identifier, *args, **kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> identifier == <span class="string">'pygame_icon.tiff'</span>:</span><br><span class="line">        <span class="keyword">raise</span> IOError()</span><br><span class="line">    <span class="keyword">return</span> _original_getResource(identifier, *args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pygame.pkgdata</span><br><span class="line">_original_getResource = pygame.pkgdata.getResource</span><br><span class="line">pygame.pkgdata.getResource = getResource</span><br></pre></td></tr></table></figure>

<h3 id="覆盖默认钩子"><a href="#覆盖默认钩子" class="headerlink" title="覆盖默认钩子"></a>覆盖默认钩子</h3><h4 id="包含-排除视频和音频并减小应用程序大小"><a href="#包含-排除视频和音频并减小应用程序大小" class="headerlink" title="包含/排除视频和音频并减小应用程序大小"></a>包含/排除视频和音频并减小应用程序大小</h4><p>PyInstaller包含一个用于kivy的钩子，默认情况下会添加kivy使用的所有核心模块，例如音频，视频，拼写等（您仍然需要使用<code>Tree()</code>手动打包gstreamer dll-参见上面的示例）及其依赖项。如果未安装挂钩或为了减小应用程序大小，则可能不包括其中某些模块，例如如果未使用音频/视频，请使用备用挂钩。</p>
<p>Kivy在<code>hookspath()</code>中提供了备用钩子。此外，当且仅当PyInstaller没有默认钩子时，还必须提供<code>runtime_hooks()</code>。当覆盖钩子时，通常不需要覆盖后者。</p>
<p>备用<code>hookspath()</code>挂钩不包含任何kivy提供程序。要添加它们，必须将它们与<code>get_deps_minimal()</code>或<code>get_deps_all()</code>添加在一起。请参阅他们的文档和pyinstaller_hooks以获取更多详细信息。但从本质上讲，<code>get_deps_all()</code>会像默认钩子一样添加所有提供程序，而<code>get_deps_minimal()</code>仅添加在运行应用程序时加载的提供程序。每种方法都提供了可传递给Analysis的隐藏的kivy导入列表和排除的导入列表。</p>
<p>一个人也可以生成一个备用钩子，该钩子从字面上列出每个kivy提供程序模块，不需要的那些可以注释掉。 请参阅pyinstaller_hooks。</p>
<p>要在上面的示例中使用备用挂钩，请进行以下修改，以添加带有<code>hookspath()</code>和<code>runtime_hooks（如果需要）</code>以及<code>**get_deps_minimal()</code>或<code>**get_deps_all()</code>的挂钩，以指定提供程序。</p>
<p>例如，添加导入语句：</p>
<p><code>from kivy.tools.packaging.pyinstaller_hooks import get_deps_minimal, get_deps_all,hookspath, runtime_hooks</code></p>
<p>然后修改分析如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = Analysis([<span class="string">'examples-path\\demo\\touchtracer\\main.py'</span>],</span><br><span class="line">            ...</span><br><span class="line">            hookspath=hookspath(),</span><br><span class="line">            runtime_hooks=runtime_hooks(),</span><br><span class="line">            ...</span><br><span class="line">            **get_deps_all())</span><br></pre></td></tr></table></figure>
<p>包括默认钩子之类的所有内容。 要么：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = Analysis([<span class="string">'examples-path\\demo\\touchtracer\\main.py'</span>],</span><br><span class="line">            ...</span><br><span class="line">            hookspath=hookspath(),</span><br><span class="line">            runtime_hooks=runtime_hooks(),</span><br><span class="line">            ...</span><br><span class="line">            **get_deps_minimal(video=<span class="literal">None</span>, audio=<span class="literal">None</span>))</span><br></pre></td></tr></table></figure>
<p>例如 排除音频和视频提供程序，而对于其他核心模块，仅使用加载的那些。</p>
<p>关键是要提供备用的<code>hookspath()</code>，默认情况下不会列出所有kivy提供程序，而是手动对隐藏的导入添加所需的提供程序，同时使用<code>get_deps_minimal()</code>删除不需要的提供程序（在此示例中为音频和视频）。</p>
<h4 id="备用安装"><a href="#备用安装" class="headerlink" title="备用安装"></a>备用安装</h4><p>先前的例子使用例如 * [[（sdl2.dep_bins + glew.dep_bins + gstreamer.dep_bins）中p的树（p）]，使PyInstaller添加这些依赖项使用的所有dll。 如果未使用wheel方法安装kivy，则这些命令将不起作用，例如 kivy_deps.sdl2将无法导入。 相反，必须找到这些dll的位置，并以与示例类似的方式将它们手动传递给Tree类。</p>
<h3 id="为Android创建一个程序包"><a href="#为Android创建一个程序包" class="headerlink" title="为Android创建一个程序包"></a>为Android创建一个程序包</h3><p>您可以使用python-for-android项目为android创建软件包。 本页说明如何直接在您自己的计算机上下载和使用它（请参阅使用python-for-android打包）或使用Buildozer工具来自动化整个过程。 您还可以看到打包应用程序以供Kivy Launcher使用，以在不进行编译的情况下运行kivy程序。</p>
<p>对于新用户，我们建议使用Buildozer作为制作完整APK的最简单方法。 您也可以使用Kivy Launcher应用程序运行Kivy应用程序，而无需进行编译步骤。</p>
<p>Kivy应用程序可以在Play商店等Android市场上发布，只需执行一些额外步骤即可创建完全签名的APK。</p>
<p>Kivy项目包含用于访问Android API的工具，以完成振动，传感器访问，发短信等功能。这些信息以及有关设备调试的信息记录在Android主页上。</p>
<h4 id="Buildozer"><a href="#Buildozer" class="headerlink" title="Buildozer"></a>Buildozer</h4><p>Buildozer是使整个构建过程自动化的工具。 它会下载并设置python-for-android的所有必备组件，包括android SDK和NDK，然后构建一个可自动推送到设备的apk。</p>
<p>Buildozer当前仅在Linux中工作，并且是Alpha版本，但它已经可以很好地工作并且可以大大简化apk的构建。</p>
<p>您可以在<code>https://github.com/kivy/buildozer</code>上获得buildozer：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/kivy/buildozer.git</span><br><span class="line">cd buildozer</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>
<p>这将在您的系统中安装buildozer。 然后，导航到您的项目目录并运行：</p>
<p><code>buildozer init</code></p>
<p>这将创建一个控制构建配置的buildozer.spec文件。 您应该使用您的应用名称等对其进行适当的编辑。您可以设置变量以控制传递给python-for-android的大多数或所有参数。</p>
<p>安装buildozer的<span class="exturl" data-url="aHR0cHM6Ly9idWlsZG96ZXIucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L2luc3RhbGxhdGlvbi5odG1sI3RhcmdldGluZy1hbmRyb2lk">依赖项<i class="fa fa-external-link-alt"></i></span>。</p>
<p>最后，插入您的android设备并运行：</p>
<p><code>buildozer android debug deploy run</code></p>
<p>在设备上构建，推送和自动运行apk。</p>
<p>Buildozer有许多可用的选项和工具可以为您提供帮助，以上步骤只是构建和运行APK的最简单方法。 完整文档可在<span class="exturl" data-url="aHR0cDovL2J1aWxkb3plci5yZWFkdGhlZG9jcy5vcmcvZW4vbGF0ZXN0Lw==">此处<i class="fa fa-external-link-alt"></i></span>获得。 您也可以在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkvYnVpbGRvemVy5LiK5p+l55yLQnVpbGRvemVy6Ieq6L+w5paH5Lu244CC">https://github.com/kivy/buildozer上查看Buildozer自述文件。<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="用python-for-android打包"><a href="#用python-for-android打包" class="headerlink" title="用python-for-android打包"></a>用python-for-android打包</h4><p>您还可以直接使用python-for-android进行打包，这可以为您提供更多控制权，但需要您手动下载Android工具链的各个部分。</p>
<p>有关完整的详细信息，请参见<span class="exturl" data-url="aHR0cHM6Ly9weXRob24tZm9yLWFuZHJvaWQucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L3F1aWNrc3RhcnQv">python-for-android文档<i class="fa fa-external-link-alt"></i></span>。</p>
<h4 id="打包您的Kivy-Launcher应用程序"><a href="#打包您的Kivy-Launcher应用程序" class="headerlink" title="打包您的Kivy Launcher应用程序"></a>打包您的Kivy Launcher应用程序</h4><p>Kivy启动器是一个Android应用程序，可运行存储在SD卡上的所有Kivy示例。 要安装Kivy启动器，您必须：</p>
<p>1.前往Google Play商店的Kivy Launcher页面</p>
<p>2.点击安装</p>
<p>3.选择您的手机。 。 。 完成了！</p>
<p>如果您无法通过手机/平板电脑访问Google Play商店，则可以从<span class="exturl" data-url="aHR0cDovL2tpdnkub3JnLyNkb3dubG9hZOaJi+WKqOS4i+i9veW5tuWuieijhUFQS+OAgg==">http://kivy.org/#download手动下载并安装APK。<i class="fa fa-external-link-alt"></i></span></p>
<p>一旦安装了Kivy启动器，您就可以将Kivy应用程序放在外部存储目录的Kivy目录中（即使在内部存储器中的设备中，通常也可以在/ sdcard上找到）。</p>
<p><code>/sdcard/kivy/&lt;yourapplication&gt;</code></p>
<p><yourapplication>应该是包含以下内容的目录：</yourapplication></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Your main application file:</span></span><br><span class="line">main.py</span><br><span class="line"><span class="comment"># Some info Kivy requires about your app on android:</span></span><br><span class="line">android.txt</span><br></pre></td></tr></table></figure>
<p>android.txt文件必须包含：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">title=&lt;Application Title&gt;</span><br><span class="line">author=&lt;Your Name&gt;</span><br><span class="line">orientation=&lt;portrait|landscape&gt;</span><br></pre></td></tr></table></figure>
<p>这些选项只是一个非常基本的配置。 如果使用上述工具创建自己的APK，则可以选择许多其他设置。</p>
<p>安装示例</p>
<p>Kivy附带了许多示例，这些示例可能是开始尝试Kivy启动器的好地方。 您可以如下运行它们：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#. Download the `Kivy demos for Android &lt;https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/kivy/kivydemo-for-android.zip&gt;`_</span></span><br><span class="line"><span class="comment">#. Unzip the contents and go to the folder `kivydemo-for-android`</span></span><br><span class="line"><span class="comment">#. Copy all the the subfolders here to</span></span><br></pre></td></tr></table></figure>
<p>/sdcard/kivy</p>
<p>1.运行启动器，然后选择“图片”，“展示”，“ Touchtracer”，“ Cymunk”或其他演示之一。</p>
<h4 id="投放市场"><a href="#投放市场" class="headerlink" title="投放市场"></a>投放市场</h4><p>如果您使用Buildozer或python-for-android构建了自己的APK，则可以创建一个发行版本，该发行版本可能会在Play商店或其他Android市场上发行。 为此，您必须使用release参数（例如，buildozer android release）运行Buildozer，或者如果使用python-for-android，请使用–release选项来build.py。 这会创建一个发布</p>
<p>bin目录中的APK，您必须正确对其进行签名和zipalign。 Android文档（<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vc3R1ZGlvL3B1Ymxpc2gvYXBw">https://developer.android.com/studio/publish/app<i class="fa fa-external-link-alt"></i></span> signing.html＃signing-manually）中描述了执行此操作的步骤-所有必需的工具都随Android SDK一起提供。</p>
<h4 id="定位Android"><a href="#定位Android" class="headerlink" title="定位Android"></a>定位Android</h4><p>Kivy旨在跨平台相同地运行，因此做出了一些明确的设计决策。 它包括自己的一组小部件，默认情况下，它会构建具有所有必需的核心依赖关系和库的APK。</p>
<p>可以直接或以（某种）跨平台方式定位特定的Android功能。 有关更多详细信息，请参见《 Android上的Kivy》的“使用Android API”部分。</p>
<h3 id="Kivy-on-Android"><a href="#Kivy-on-Android" class="headerlink" title="Kivy on Android"></a>Kivy on Android</h3><p>您可以在（或多或少）具有OpenGL ES 2.0（最低Android 2.2）的任何设备上的Android上运行Kivy应用程序。 这是现代设备的标准配置。 Google报告说<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vYWJvdXQvZGFzaGJvYXJkcy9pbmRleC5odG1s">99.9％的设备<i class="fa fa-external-link-alt"></i></span>可以满足要求。</p>
<p>Kivy APK是普通的Android应用，您可以像分发其他应用一样分发，包括在Play商店等商店中。 它们在暂停或重新启动时行为正常，可以使用Android服务，并可以访问大多数常规Java API，如下所述。</p>
<p>请按照以下说明学习如何为Android打包您的应用，如何在设备上调试代码以及如何使用Android API（例如振动和读取传感器）。</p>
<h4 id="Android套件"><a href="#Android套件" class="headerlink" title="Android套件"></a>Android套件</h4><p>Kivy项目提供了在Android上打包您的应用程序所需的所有必要工具，包括构建自己的独立APK，该APK可在Play商店等市场上分发。 “创建Android包”文档中对此进行了全面介绍。</p>
<h4 id="在Android平台上调试应用程序"><a href="#在Android平台上调试应用程序" class="headerlink" title="在Android平台上调试应用程序"></a>在Android平台上调试应用程序</h4><p>您可以通过Android logcat流查看代码的常规输出（stdout，stderr）以及常规的Kivy日志。 可通过Android SDK提供的adb访问此文件。 您可能需要在设备的开发人员选项中启用adb，然后将设备连接到计算机并运行：</p>
<p><code>adb logcat</code></p>
<p>您会看到所有日志，包括stdout / stderr和Kivy记录器。</p>
<p>如果您将应用程序与Buildozer打包在一起，则adb工具可能不在$ PATH中，并且上述命令可能不起作用。 您可以改为运行：</p>
<p><code>buildozer android logcat</code></p>
<p>运行Buildozer安装的版本，或在<code>$ HOME/.buildozer/android/platform</code>中找到SDK工具。<br>您还可以使用<span class="exturl" data-url="aHR0cHM6Ly9wbGF5Lmdvb2dsZS5jb20vc3RvcmUvYXBwcy9kZXRhaWxzP2lkPW9yZy5raXZ5LnB5Z2FtZSZobD1lbg==">Kivy Launcher<i class="fa fa-external-link-alt"></i></span>运行和调试应用程序。 如果以这种方式运行应用程序，则会在应用程序文件夹的<code>/.kivy/logs</code>子文件夹中找到日志文件。</p>
<h4 id="使用Android-API"><a href="#使用Android-API" class="headerlink" title="使用Android API"></a>使用Android API</h4><p>尽管Kivy是Python框架，但Kivy项目维护的工具可以轻松使用常规的Java API，适用于从振动到传感器到通过SMS或电子邮件发送消息的所有内容。</p>
<p>对于新用户，我们建议使用Plyer。 对于更高级的访问或当前未包装的API，您可以直接使用Pyjnius。 Kivy还提供了用于基本Android功能的android模块。</p>
<p>用户提供的Android代码和示例可在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkva2l2eS93aWtpI21vYmlsZXM=">Kivy Wiki<i class="fa fa-external-link-alt"></i></span>上找到。</p>
<p>夹层</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkvcGx5ZXI=">Plyer<i class="fa fa-external-link-alt"></i></span>是pythonic的，独立于平台的API，可使用各种平台（尤其是移动平台）上常见的功能。 这样的想法是，您的应用程序可以调用简单地调用Plyer函数，例如向用户呈现通知，而Plyer会以正确的方式进行操作，而不管平台或操作系统如何。 在内部，Plyer使用Pyjnius（在Android上），Pyobjus（在iOS上）和某些台式机平台上特定于平台的API。</p>
<p>例如，以下代码将使您的Android设备振动，或引发NotImplemented- Error，您可以在其他平台（例如没有适当硬件的台式机）上适当处理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> plyer <span class="keyword">import</span> vibrator</span><br><span class="line">vibrator.vibrate(<span class="number">10</span>) <span class="comment"># vibrate for 10 seconds</span></span><br></pre></td></tr></table></figure>
<p>Plyer支持的API列表正在迅速增长，您可以在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkvcGx5ZXI=">Plyer自述文件<i class="fa fa-external-link-alt"></i></span>中查看完整列表。</p>
<p>平壤</p>
<p>Pyjnius是一个Python模块，可让您直接从Python访问Java类，将参数自动转换为正确的类型，并轻松将Java结果转换为Python。</p>
<p>Pyjnius可以从<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkvcHlqbml1cw==">github<i class="fa fa-external-link-alt"></i></span>获得，并且有<span class="exturl" data-url="aHR0cDovL3B5am5pdXMucmVhZHRoZWRvY3Mub3JnL2VuL2xhdGVzdC8=">自己的文档<i class="fa fa-external-link-alt"></i></span>。</p>
<p>这是一个简单的示例，展示了Pyjnius能够访问常规Android振动API的功能，与上述plyer代码的结果相同：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 'autoclass' takes a java class and gives it a Python wrapper</span></span><br><span class="line"><span class="keyword">from</span> jnius <span class="keyword">import</span> autoclass</span><br><span class="line"></span><br><span class="line"><span class="comment"># Context is a normal java class in the Android API</span></span><br><span class="line">Context = autoclass(<span class="string">'android.content.Context'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># PythonActivity is provided by the Kivy bootstrap app in python-for-android</span></span><br><span class="line">PythonActivity = autoclass(<span class="string">'org.renpy.android.PythonActivity'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The PythonActivity stores a reference to the currently running activity</span></span><br><span class="line"><span class="comment"># We need this to access the vibrator service</span></span><br><span class="line">activity = PythonActivity.mActivity</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is almost identical to the java code for the vibrator</span></span><br><span class="line">vibrator = activity.getSystemService(Context.VIBRATOR_SERVICE)</span><br><span class="line">vibrator.vibrate(<span class="number">10000</span>) <span class="comment"># The value is in milliseconds - this is 10s</span></span><br></pre></td></tr></table></figure>
<p>该代码直接遵循Java API函数来调用振动器，Pyjnius会自动将api转换为Python代码，然后将我们的调用转换回等效的java。 它比Plyer的版本更加冗长和类似Java，在这种情况下没有好处，尽管Plyer并未包装Pyjnius可用的所有API。</p>
<p>Pyjnius还具有实现Java接口的强大功能，这对于包装某些API非常重要，但此处未进行记录-您可以查看Pyjnius<span class="exturl" data-url="aHR0cDovL3B5am5pdXMucmVhZHRoZWRvY3Mub3JnL2VuL2xhdGVzdC8=">自己的文档<i class="fa fa-external-link-alt"></i></span>。</p>
<p>Android模块</p>
<p>适用于Android的Python包含一个python模块（实际上是cython包装Java），用于访问一组有限的Android API。 如上所述，这已经被更灵活的Pyjnius和Plyer所取代，但有时仍然有用。 可用的功能在<a href="http://python-for-android.readthedocs.org/en/latest/" target="_blank" rel="noopener"><code>python-for-android</code>文档</a>中给出。</p>
<p>其中包括用于结算/IAP和创建/访问Android服务的代码，上述其他工具尚不提供此代码。</p>
<h4 id="项目和经过测试的设备的状态"><a href="#项目和经过测试的设备的状态" class="headerlink" title="项目和经过测试的设备的状态"></a>项目和经过测试的设备的状态</h4><p>前面这些部分描述了Kivy的Android构建工具的存在，其局限性以及已知可以运行的某些设备。</p>
<p>Android工具现在非常稳定，几乎可以在任何设备上使用。 我们的最低要求是OpenGL ES 2.0和Android 2.2。 这些现在很常见-Kivy甚至可以在Android智能手表上运行！</p>
<p>当前的技术限制是Android构建工具只能编译ARM APK，而ARM APK不能在具有x86处理器的Android设备上运行（目前很少见）。 这应该尽快添加。</p>
<p>由于Kivy在大多数设备上都能正常工作，因此支持的手机/平板电脑列表已淘汰-如果所有Android设备都符合上述条件，则它们可能会正常工作。</p>
<h3 id="为OS-X创建软件包"><a href="#为OS-X创建软件包" class="headerlink" title="为OS X创建软件包"></a>为OS X创建软件包</h3><hr>
<p><strong>注意：本指南描述了打包Kivy应用程序的多种方法。 建议与PyInstaller包装在一起使用。</strong></p>
<hr>
<h4 id="使用PyInstaller和Homebrew"><a href="#使用PyInstaller和Homebrew" class="headerlink" title="使用PyInstaller和Homebrew"></a>使用PyInstaller和Homebrew</h4><hr>
<p><strong>注意：将您的应用程序打包到您要支持的最旧的OS X版本上。</strong></p>
<hr>
<p>完整指南</p>
<p>1.安装自制软件</p>
<p>2.安装Python：</p>
<p><code>$ brew install python</code></p>
<hr>
<p><strong>注意：要使用Python 3，请在下面的指南中brew安装python3并将pip替换为pip3。</strong></p>
<hr>
<p>3.使用–build-bottle（重新）安装依赖项，以确保它们可以在其他计算机上使用：</p>
<p><code>$ brew reinstall --build-bottle sdl2 sdl2_image sdl2_ttf sdl2_mixer</code></p>
<hr>
<p><strong>注意：如果您的项目依赖于GStreamer或其他附加库，请使用–build-bottle重新安装它们，如下所述。</strong></p>
<hr>
<p>4.安装Cython和Kivy：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pip install Cython==<span class="number">0.29</span><span class="number">.14</span></span><br><span class="line">$ pip install -U kivy</span><br></pre></td></tr></table></figure>
<p>5.安装PyInstaller：</p>
<p><code>$ pip install -U pyinstaller</code></p>
<p>6.使用main.py的路径打包应用程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ pyinstaller -y --clean --windowed --name touchtracer \</span><br><span class="line">  --exclude-module _tkinter \</span><br><span class="line">  --exclude-module Tkinter \</span><br><span class="line">  --exclude-module enchant \</span><br><span class="line">  --exclude-module twisted \</span><br><span class="line">  /usr/local/share/kivy-examples/demo/touchtracer/main.py</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>注意：这将不会复制其他图像或声音文件。 您需要为此修改创建的.spec文件。</strong></p>
<hr>
<p>编辑规格文件</p>
<p>specs文件名为touchtracer.spec，位于您运行pyinstaller命令的目录中。</p>
<p>您需要更改COLLECT（）调用以添加touchtracer的数据（touchtracer.kv，Particle.png，…）。 更改该行以添加Tree（）对象。 该树将搜索并将在touchtracer目录中找到的每个文件添加到最终包中。 您的COLLECT部分应如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">coll = COLLECT(exe, Tree(<span class="string">'/usr/local/share/kivy-examples/demo/touchtracer/'</span>),</span><br><span class="line">                a.binaries,</span><br><span class="line">                a.zipfiles,</span><br><span class="line">                a.datas,</span><br><span class="line">                strip=<span class="literal">None</span>,</span><br><span class="line">                upx=<span class="literal">True</span>,</span><br><span class="line">                name=<span class="string">'touchtracer'</span>)</span><br></pre></td></tr></table></figure>
<p>这将添加所需的挂钩，以便PyInstaller获取所需的Kivy文件。我们完了。您的规格已准备就绪，可以执行。</p>
<p>建立规范并创建DMG</p>
<p>1.打开控制台。</p>
<p>2.转到PyInstaller目录，并建立规范：</p>
<p><code>$ pyinstaller -y --clean --windowed touchtracer.spec</code></p>
<p>3.执行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ pushd dist</span><br><span class="line">$ hdiutil create ./Touchtracer.dmg -srcfolder touchtracer.app -ov</span><br><span class="line">$ popd</span><br></pre></td></tr></table></figure>

<p>4.现在，您将在dist目录中获得一个<code>Touchtracer.dmg</code>。</p>
<p>附加图书馆</p>
<p>GStreamer</p>
<p>如果您的项目依赖于GStreamer：</p>
<p><code>$ brew reinstall --build-bottle gstreamer gst-plugins-{base,good,bad,ugly}</code></p>
<hr>
<p><strong>注意：如果您的项目需要Ogg Vorbis支持，请确保在上述命令中添加–with-libvorbis选项。</strong></p>
<hr>
<p>如果您使用的是Homebrew的Python，则在合并此拉取请求之前，还需要执行以下步骤：</p>
<p><code>$ brew reinstall --with-python --build-bottle https://github.com/cbenhagen/homebrew/raw/patch-3/Library/Formula/gst-python.rb</code></p>
<h4 id="在没有Homebrew的情况下使用PyInstaller"><a href="#在没有Homebrew的情况下使用PyInstaller" class="headerlink" title="在没有Homebrew的情况下使用PyInstaller"></a>在没有Homebrew的情况下使用PyInstaller</h4><p>首先在不使用Homebrew的情况下安装Kivy及其依赖项，如<span class="exturl" data-url="aHR0cDovL2tpdnkub3JnL2RvY3MvaW5zdGFsbGF0aW9uL2luc3RhbGxhdGlvbi5odG1sI2RldmVsb3BtZW50LXZlcnNpb27miYDov7DjgII=">http://kivy.org/docs/installation/installation.html#development-version所述。<i class="fa fa-external-link-alt"></i></span></p>
<p>一旦安装了kivy及其dep，就需要安装PyInstaller。</p>
<p>假设我们使用了像testpackaging这样的文件夹：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd testpackaging</span><br><span class="line">git clone http://github.com/pyinstaller/pyinstaller</span><br></pre></td></tr></table></figure>
<p>在此目录中创建一个名为<code>touchtracer.spec</code>的文件，并向其中添加以下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- mode: python -*-</span></span><br><span class="line">block_cipher = <span class="literal">None</span></span><br><span class="line"><span class="keyword">from</span> kivy.tools.packaging.pyinstaller_hooks <span class="keyword">import</span> get_deps_all, hookspath,runtime_hooks</span><br><span class="line">a = Analysis([<span class="string">'/path/to/yout/folder/containing/examples/demo/touchtracer/main.py'</span>],</span><br><span class="line">             pathex=[<span class="string">'/path/to/yout/folder/containing/testpackaging'</span>],</span><br><span class="line">             binaries=<span class="literal">None</span>,</span><br><span class="line">             win_no_prefer_redirects=<span class="literal">False</span>,</span><br><span class="line">             win_private_assemblies=<span class="literal">False</span>,</span><br><span class="line">             cipher=block_cipher,</span><br><span class="line">             hookspath=hookspath(),</span><br><span class="line">             runtime_hooks=runtime_hooks(),</span><br><span class="line">             **get_deps_all())</span><br><span class="line">pyz = PYZ(a.pure, a.zipped_data,</span><br><span class="line">          cipher=block_cipher)</span><br><span class="line">exe = EXE(pyz,</span><br><span class="line">            a.scripts,</span><br><span class="line">            exclude_binaries=<span class="literal">True</span>,</span><br><span class="line">            name=<span class="string">'touchtracer'</span>,</span><br><span class="line">            debug=<span class="literal">False</span>,</span><br><span class="line">            strip=<span class="literal">False</span>,</span><br><span class="line">            upx=<span class="literal">True</span>,</span><br><span class="line">            console=<span class="literal">False</span> )</span><br><span class="line">coll = COLLECT(exe, Tree(<span class="string">'../kivy/examples/demo/touchtracer/'</span>),</span><br><span class="line">                Tree(<span class="string">'/Library/Frameworks/SDL2_ttf.framework/Versions/A/Frameworks/FreeType.framework'</span>),</span><br><span class="line">                a.binaries,</span><br><span class="line">                a.zipfiles,</span><br><span class="line">                a.datas,</span><br><span class="line">                strip=<span class="literal">False</span>,</span><br><span class="line">                upx=<span class="literal">True</span>,</span><br><span class="line">                name=<span class="string">'touchtracer'</span>)</span><br><span class="line">app = BUNDLE(coll,</span><br><span class="line">                name=<span class="string">'touchtracer.app'</span>,</span><br><span class="line">                icon=<span class="literal">None</span>,</span><br><span class="line">                bundle_identifier=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>使用相关路径更改路径：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = Analysis（[<span class="string">'/ path / to / yout / folder / contains / examples / demo / touchtracer / main.py'</span>]，				pathex = [<span class="string">'/ path / to / yout / folder /包含/ testpackaging'</span>]，</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">coll = COLLECT（exe，Tree（<span class="string">'../ kivy / examples / demo / touchtracer /'</span>），</span><br></pre></td></tr></table></figure>

<p>然后运行以下命令：</p>
<figure class="highlight plain"><figcaption><span>/ pyinstaller.py touchtracer.spec```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在适当的地方用您的应用替换touchtracer。 这将在dist &#x2F;文件夹中为您提供一个&lt;yourapp&gt; .app。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 使用Buildozer</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;pip install git+http:&#x2F;&#x2F;github.com&#x2F;kivy&#x2F;buildozer cd &#x2F;to&#x2F;where&#x2F;I&#x2F;Want&#x2F;to&#x2F;package buildozer init</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>注意：必须在OS X内使用以下方法打包Kivy应用程序，不再支持32位平台。</strong></p>
<hr>
<p>编辑buildozer.spec并添加您的应用程序的详细信息。 依赖关系可以添加到“ requirements =”部分。</p>
<p>默认情况下，将忽略需求中指定的kivy版本。</p>
<p>如果您在/Applications/Kivy.app上有一个Kivy.app，则将其用于打包。 否则，将下载并使用kivy.org中使用Kivy master的最新版本。</p>
<p>如果要打包python 3.x.x，只需从kivy.org的下载部分下载名为Kivy3.7z的软件包，然后将其解压缩到/ Applications中的Kivy.app，然后运行：</p>
<figure class="highlight plain"><figcaption><span>osx debug```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">将应用打包后，如果不需要视频支持，则可能要删除不需要的包，例如gstreamer。 相同的逻辑适用于您不使用的其他内容，只需将程序包减小到运行该应用程序所需的最小状态即可。</span><br><span class="line"></span><br><span class="line">作为示例，我们包括针对Python 2（9.xMB）和3（15.xMB）使用此方法打包的展示示例，您可以在以下位置找到这些包：[https:&#x2F;&#x2F;drive.google.com&#x2F;drive&#x2F;folders &#x2F;0B1WO07-OL50_alFzSXJUajBFdnc。](https:&#x2F;&#x2F;drive.google.com&#x2F;drive&#x2F;folders&#x2F;0B1WO07-OL50_alFzSXJUajBFdnc)</span><br><span class="line"></span><br><span class="line">而已。 请享用！</span><br><span class="line"></span><br><span class="line">Buildozer现在使用Kivy SDK打包您的应用程序。 如果要控制的应用程序详细信息比buildozer当前提供的更多，则可以直接使用SDK，如以下部分中所述。</span><br><span class="line"></span><br><span class="line">#### 使用Kivy SDK</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**注意：Kivy.app目前无法下载。 有关详细信息，请参见此问题。**</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**注意：必须在OS X内使用以下方法打包Kivy应用程序，不再支持32位平台。**</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">从1.9.0版开始，Kivy以自包含，可移植的发行版发布用于OS X平台。</span><br><span class="line"></span><br><span class="line">可以使用Kivy SDK使用以下描述的方法来打包和分发应用程序，从而更轻松地包含SDL2和GStreamer之类的框架。</span><br><span class="line"></span><br><span class="line">1.确保从下载页面获得未修改的Kivy SDK（Kivy.app）。</span><br><span class="line"></span><br><span class="line">2.运行以下命令：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">&gt; mkdir packaging</span><br><span class="line">&gt; cd packaging</span><br><span class="line">packaging&gt; git clone https:&#x2F;&#x2F;github.com&#x2F;kivy&#x2F;kivy-sdk-packager</span><br><span class="line">packaging&gt; cd kivy-sdk-packager&#x2F;osx</span><br><span class="line">osx&gt; cp -a &#x2F;Applications&#x2F;Kivy.app .&#x2F;Kivy.App</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>注意：以上步骤很重要，您必须确保保留路径和权限。 诸如cp -rf之类的命令将复制但使该应用程序无法使用，并在以后导致错误。</strong></p>
<hr>
<p>3.现在，您需要做的就是通过运行以下命令将编译后的应用程序包含在Kivy.app中：</p>
<figure class="highlight plain"><figcaption><span>./package-app.sh</span><a href="/path/to/your/<app_folder_name>/```">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">其中&lt;app_folder_name&gt;是您的应用程序的名称。</span><br><span class="line"></span><br><span class="line">这会将Kivy.app复制到&lt;app_folder_name&gt; .app，并将应用程序的已编译副本包含到此程序包中。</span><br><span class="line"></span><br><span class="line">4.就是这样，您已经准备好部署独立的软件包！ 现在，您可以按照下面的说明进一步自定义应用。</span><br><span class="line"></span><br><span class="line">安装模块</span><br><span class="line"></span><br><span class="line">osx上的Kivy软件包使用其自己的虚拟环境，当您使用kivy命令运行应用程序时会激活该环境。 要安装任何模块，您需要像这样安装模块：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;$ kivy -m pip install &lt;modulename&gt;</span><br></pre></td></tr></table></figure>

<p>模块/文件安装在哪里？</p>
<p>在应用内的便携式venv中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果您安装了安装二进制文件的模块，例如kivy-garden，那么该二进制文件仅可从上面的venv中获得，如下所示：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;kivy -m pip install kivy-garden</span><br></pre></td></tr></table></figure>

<p>仅当您激活此环境时，花园lib才可用。</p>
<p>源<code>/Applications/Kivy.app/Contents/Resources/venv/bin/activate</code>花园安装mapview停用</p>
<p>安装二进制文件</p>
<p>只需将二进制文件复制到<code>Kivy.app/Contents/Resources/venv/bin/</code>目录。</p>
<p>包括其他框架</p>
<p>Kivy.app附带提供的SDL2和Gstreamer框架。 要包括除提供的框架以外的框架，请执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone http://github.com/tito/osxrelocator</span><br><span class="line">export PYTHONPATH=~/path/to/osxrelocator</span><br><span class="line">cd Kivy.app</span><br><span class="line">python -m osxrelocator -r . /Library/Frameworks/&lt;Framework_name&gt;.framework/ \</span><br><span class="line"><span class="meta">@executable_path/../Frameworks/&lt;Framework_name&gt;.framework/</span></span><br></pre></td></tr></table></figure>

<p>不要忘记用您的框架替换<Framework_name>。 该工具osxrelocator实质上更改了框架中lib的路径，以使它们相对于.app中的可执行文件，从而使Framework可随.app移植。</Framework_name></p>
<p>缩小应用程序大小</p>
<p>该应用目前具有相当大的尺寸，但是不需要的部分可以从包装中取出。</p>
<p>例如，如果您不使用GStreamer，则只需将其从<code>YourApp.app/Contents/Frameworks</code>中删除。 同样，您可以从<code>/ Applications / Kivy.app/Contents/Resources/kivy/examples/</code>或<code>kivy/tools，kivy/docs</code>等中删除examples文件夹。</p>
<p>这样，可以使程序包仅包含应用程序所需的部分。</p>
<p>调整设定</p>
<p>您可以通过编辑<code>YourApp/Contents/info.plist</code>来更改应用程序的图标和其他设置，以适应您的需求。</p>
<p>创建一个DMG</p>
<p>要使用您的应用程序制作DMG，请使用以下命令：</p>
<figure class="highlight plain"><figcaption><span>./create-osx-dmg.sh YourApp.app```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">请注意末尾缺少&#x2F;。 这应该为您提供一个压缩的dmg，它将进一步缩小您的分布式应用程序的大小。</span><br><span class="line"></span><br><span class="line">### 为IOS创建一个包</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**注意：目前，kivy-iOS使用Python 2.7和3.7构建软件包。**</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">可以通过4个步骤来说明为IOS创建软件包的整个过程：</span><br><span class="line"></span><br><span class="line">1.编译发行版（适用于IOS的python +模块）</span><br><span class="line"></span><br><span class="line">2.创建一个Xcode项目（并链接您的源代码）</span><br><span class="line"></span><br><span class="line">3.更新Xcode项目</span><br><span class="line"></span><br><span class="line">4.自定义Xcode项目</span><br><span class="line"></span><br><span class="line">#### 先决条件</span><br><span class="line"></span><br><span class="line">您需要安装一些依赖项，例如Cython，自动工具等。我们建议您使用[Homebrew](http:&#x2F;&#x2F;mxcl.github.com&#x2F;homebrew&#x2F;)安装这些依赖项：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">brew install autoconf automake libtool pkg-config</span><br><span class="line">brew link libtool</span><br><span class="line">sudo easy_install pip</span><br><span class="line">sudo pip install Cython&#x3D;&#x3D;0.29.14</span><br></pre></td></tr></table></figure>

<p>有关更多详细信息，请参见IOS先决条件。 在开始第二步之前，只需确保一切正常即可！</p>
<h4 id="编译发行版"><a href="#编译发行版" class="headerlink" title="编译发行版"></a>编译发行版</h4><p>打开一个终端，然后键入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git://github.com/kivy/kivy-ios</span><br><span class="line">$ cd kivy-ios</span><br><span class="line">$ ./toolchain.py build kivy</span><br></pre></td></tr></table></figure>

<p>大部分python发行版都打包在python27.zip中。 如果您遇到任何问题，请参考<span class="exturl" data-url="aHR0cHM6Ly9ncm91cHMuZ29vZ2xlLmNvbS9mb3J1bS8jIWZvcnVtL2tpdnktdXNlcnM=">我们的用户组<i class="fa fa-external-link-alt"></i></span>或<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkva2l2eS1pb3M=">kivy-ios项目<i class="fa fa-external-link-alt"></i></span>页面。</p>
<h4 id="创建一个Xcode项目"><a href="#创建一个Xcode项目" class="headerlink" title="创建一个Xcode项目"></a>创建一个Xcode项目</h4><p>在继续下一步之前，请确保您的应用程序入口点是一个名为main.py的文件。</p>
<p>我们提供了一个脚本，用于创建一个初始的Xcode项目。 在下面的命令行中，将test替换为您的项目名称。 它必须是一个没有空格或非法字符的名称：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ./toolchain.py create &lt;title&gt; &lt;app_directory&gt;</span><br><span class="line">$ ./toolchain.py create Touchtracer ~/code/kivy/examples/demo/touchtracer</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>注意：您必须使用到应用程序目录的标准路径。</strong></p>
<hr>
<p>将创建一个名为<title> -ios的目录，其中包含一个Xcode项目。 您可以打开Xcode项目：</title></p>
<figure class="highlight plain"><figcaption><span>open touchtracer-ios/touchtracer.xcodeproj```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">然后单击“播放”，然后欣赏。</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**注意：每按一次Play，您的应用程序目录将被同步到&lt;title&gt; -ios &#x2F; YourApp目录。 不要直接在-ios目录中进行更改。**</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">#### 更新Xcode项目</span><br><span class="line"></span><br><span class="line">假设您要向项目添加numpy，但在创建XCode项目之前并未对其进行编译。 首先，确保它是构建的：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;$ .&#x2F;toolchain.py build numpy</span><br></pre></td></tr></table></figure>

<p>然后，更新您的Xcode项目：</p>
<p><code>$ ./toolchain.py update touchtracer-ios</code></p>
<p>运行所有已编译配方所需的所有库/框架都将添加到您的Xcode项目中。</p>
<h4 id="自定义Xcode项目"><a href="#自定义Xcode项目" class="headerlink" title="自定义Xcode项目"></a>自定义Xcode项目</h4><p>有多种自定义和配置应用程序的方法。 请参阅<span class="exturl" data-url="aHR0cDovL3d3dy5naXRodWIuY29tL2tpdnkva2l2eS1pb3M=">kivy-ios文档<i class="fa fa-external-link-alt"></i></span>以获取更多信息。</p>
<h4 id="已知的问题"><a href="#已知的问题" class="headerlink" title="已知的问题"></a>已知的问题</h4><p>当前在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpdnkva2l2eS1pb3MvaXNzdWVz">“问题”<i class="fa fa-external-link-alt"></i></span>页面上跟踪了iOS打包的所有已知问题。 如果您遇到此处未列出的特定于iOS包装的问题，请随时提交新的问题，我们将尽快与您联系。</p>
<p>尽管大多数技术都不适合在此处编写，但一个重要的已知问题是当前无法删除某些库（例如用于音频的SDL_Mixer），因为kivy项目需要这样做。 我们将在以后的版本中修复此问题和其他问题。</p>
<h4 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h4><p>申请异常退出！</p>
<p>默认情况下，控制台和文件的所有打印语句都将被忽略。 如果在运行应用程序时遇到问题，可以通过在main.m中注释掉以下行来激活日志：</p>
<p>123</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/03/03/Kivy参考文档（二）/" rel="bookmark">Kivy参考文档（二）</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2020/02/12/Kivy参考文档（一）/" rel="bookmark">Kivy参考文档（一）</a></div>
    </li>
  </ul>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Shuoshuo
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://blog.shuoshuoyun.cn/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%B8%89%EF%BC%89/" title="Kivy参考文档（三）">https://blog.shuoshuoyun.cn/2020/03/03/Kivy参考文档（三）/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/kivy/" rel="tag"><i class="fa fa-tag"></i> kivy</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/03/03/Kivy%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3%EF%BC%88%E4%BA%8C%EF%BC%89/" rel="prev" title="Kivy参考文档（二）">
      <i class="fa fa-chevron-left"></i> Kivy参考文档（二）
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/03/20/%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E9%9B%86/" rel="next" title="爬虫项目集">
      爬虫项目集 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">湘ICP备20008495号-1 </span>
      <img src="/images/beian.png" style="display: inline-block;"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTQzMDUyMzAyMDAwMTIz">湘公网安备 43052302000123号 </span>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shuoshuo</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/next-theme/pjax@0/pjax.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  











<script data-pjax>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




    <div class="pjax">
  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: location.pathname,
    }, {"enable":true,"appId":"SRvHJbrJB86zbizktl0F4Wz3-gzGzoHsz","appKey":"m3kGoyrm4o4V0uNWsxXkrUDF","placeholder":"说点什么吧~","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"language":"zh-cn","visitor":false,"comment_count":true,"recordIP":true,"serverURLs":null}
    ));
  }, window.Valine);
});
</script>

    </div>
</body>
</html>
